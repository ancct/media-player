{"version":3,"file":"media-player.js","sources":["../media-player.js"],"sourcesContent":["/* Media Player\n/* ====================================================================== */\n\nexport default function MediaPlayer(media, rawopts) { // eslint-disable-line complexity\n\t/* Options\n\t/* ====================================================================== */\n\n\tconst self = this;\n\tconst opts = Object(rawopts);\n\tconst prefix = opts.prefix || 'media';\n\tconst lang = Object(opts.lang);\n\tconst svgs = Object(opts.svgs);\n\n\tconst timeDir = opts.timeDir || 'ltr';\n\tconst volumeDir = opts.volumeDir || 'ltr';\n\n\t/* Elements\n\t/* ====================================================================== */\n\n\tconst document = media.ownerDocument;\n\n\tself.media = $(media, {\n\t\tcanplaythrough: onCanPlayStart,\n\t\tloadstart: onLoadStart,\n\t\tloadeddata: onLoadedData,\n\t\tpause: onPlayChange,\n\t\tplay: onPlayChange,\n\t\ttimeupdate: onTimeChange,\n\t\tvolumechange: onVolumeChange\n\t});\n\n\t// play/pause toggle\n\tself.playSymbol = svg(prefix, svgs, 'play');\n\tself.pauseSymbol = svg(prefix, svgs, 'pause');\n\tself.play = $('button', { class: `${prefix}-control ${prefix}-play`, click: onPlayClick, keydown: onTimeKeydown }, self.playSymbol, self.pauseSymbol);\n\n\t// time slider\n\tself.timeMeter = $('span', { class: `${prefix}-meter ${prefix}-time-meter` });\n\tself.timeRange = $('span', { class: `${prefix}-range ${prefix}-time-range` }, self.timeMeter);\n\tself.time = $('button', { class: `${prefix}-slider ${prefix}-time`, role: 'slider', 'aria-label': lang.currentTime || 'current time', 'data-dir': timeDir, click: onTimeClick, keydown: onTimeKeydown }, self.timeRange);\n\n\t// current time text\n\tself.currentTimeText = document.createTextNode('');\n\tself.currentTime = $('span', { class: `${prefix}-text ${prefix}-current-time`, role: 'timer', 'aria-label': lang.currentTime || 'current time' }, self.currentTimeText);\n\n\t// remaining time text\n\tself.remainingTimeText = document.createTextNode('');\n\tself.remainingTime = $('span', { class: `${prefix}-text ${prefix}-remaining-time`, role: 'timer', 'aria-label': lang.remainingTime || 'remaining time' }, self.remainingTimeText);\n\n\t// mute/unmute toggle\n\tself.muteSymbol = svg(prefix, svgs, 'mute');\n\tself.unmuteSymbol = svg(prefix, svgs, 'unmute');\n\tself.mute = $('button', { class: `${prefix}-control ${prefix}-mute`, click: onMuteClick, keydown: onVolumeKeydown }, self.muteSymbol, self.unmuteSymbol);\n\n\t// volume slider\n\tself.volumeMeter = $('span', { class: `${prefix}-meter ${prefix}-volume-meter` });\n\tself.volumeRange = $('span', { class: `${prefix}-range ${prefix}-volume-range` }, self.volumeMeter);\n\tself.volume = $('button', { class: `${prefix}-slider ${prefix}-volume`, role: 'slider', 'aria-label': lang.volume || 'volume', 'data-dir': volumeDir, click: onVolumeClick, keydown: onVolumeKeydown }, self.volumeRange);\n\n\t// download link\n\tself.downloadSymbol = svg(prefix, svgs, 'download');\n\tself.download = $('button', { class: `${prefix}-control ${prefix}-download`, 'aria-label': lang.download || 'download', click: onDownloadClick }, self.downloadSymbol);\n\n\t// fullscreen link\n\tself.enterFullscreenSymbol = svg(prefix, svgs, 'enterFullscreen');\n\tself.leaveFullscreenSymbol = svg(prefix, svgs, 'leaveFullscreen');\n\tself.fullscreen = $('button', { class: `${prefix}-control ${prefix}-fullscreen`, click: onFullscreenClick }, self.enterFullscreenSymbol, self.leaveFullscreenSymbol);\n\n\t// player toolbar\n\tself.toolbar = $('div',\n\t\t{ class: `${prefix}-toolbar`, role: 'toolbar', 'aria-label': lang.player || 'media player' },\n\t\tself.play, self.mute,self.volume, self.currentTime, self.time, self.remainingTime, self.download, self.fullscreen\n\t);\n\n\t// player\n\tconst player = self.player = $('div', { class: `${prefix}-player`, role: 'region', 'aria-label': lang.player || 'media player' }, self.toolbar);\n\n\t// fullscreen api\n\tconst fullscreenchange = self._fullscreenchange = 'onfullscreenchange' in player ? 'fullscreenchange' : 'onwebkitfullscreenchange' in player ? 'webkitfullscreenchange' : 'onmozfullscreenchange' in player ? 'mozfullscreenchange' : 'onMSFullscreenChange' in player ? 'MSFullscreenChange' : 'fullscreenchange';\n\tconst fullscreenElement = self._fullscreenElement = () => document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;\n\tconst requestFullscreen = self._requestFullscreen = player.requestFullscreen || player.webkitRequestFullscreen || player.mozRequestFullScreen || player.msRequestFullscreen;\n\tconst exitFullscreen = self._exitFullscreen = () => document.exitFullscreen || document.webkitCancelFullScreen || document.mozCancelFullScreen || document.msExitFullscreen;\n\n\t// listen for fullscreen changes\n\tdocument.addEventListener(fullscreenchange, onFullscreenChange);\n\n\t// update media class and controls\n\t$(media, { class: `${prefix}-media`, playsinline: '', 'webkit-playsinline': '', role: 'img', tabindex: -1 }).controls = false;\n\n\t// replace the media element with the media player\n\tif (media.parentNode) {\n\t\tplayer.insertBefore(\n\t\t\tmedia.parentNode.replaceChild(player, media),\n\t\t\tself.toolbar\n\t\t);\n\t}\n\n\t/* Interval Events\n\t/* ====================================================================== */\n\n\tlet paused, currentTime, duration, interval;\n\n\t// when the play state changes\n\tfunction onPlayChange() {\n\t\tif (paused !== media.paused) {\n\t\t\tpaused = media.paused;\n\n\t\t\t$(self.play, { 'aria-label': paused ? lang.play || 'play' : lang.pause || 'pause' });\n\t\t\t$(self.playSymbol, { 'aria-hidden': !paused });\n\t\t\t$(self.pauseSymbol, { 'aria-hidden': paused });\n\n\t\t\tclearInterval(interval);\n\n\t\t\tif (!paused) {\n\t\t\t\t// listen for time changes every 30th of a second\n\t\t\t\tinterval = setInterval(onTimeChange, 34);\n\t\t\t}\n\n\t\t\t// dispatch new \"playchange\" event\n\t\t\tdispatchCustomEvent(media, 'playchange');\n\t\t}\n\t}\n\n\t// when the time changes\n\tfunction onTimeChange() {\n\t\tif (currentTime !== media.currentTime || duration !== media.duration) {\n\t\t\tcurrentTime = media.currentTime;\n\t\t\tduration = media.duration || 0;\n\n\t\t\tconst currentTimePercentage = currentTime / duration;\n\t\t\tconst currentTimeCode = timeToTimecode(currentTime);\n\t\t\tconst remainingTimeCode = timeToTimecode(duration - Math.floor(currentTime));\n\n\t\t\tif (currentTimeCode !== self.currentTimeText.nodeValue) {\n\t\t\t\tself.currentTimeText.nodeValue = currentTimeCode;\n\n\t\t\t\t$(self.currentTime, { title: `${timeToAural(currentTime, lang.minutes || 'minutes', lang.seconds || 'seconds')}` });\n\t\t\t}\n\n\t\t\tif (remainingTimeCode !== self.remainingTimeText.nodeValue) {\n\t\t\t\tself.remainingTimeText.nodeValue = remainingTimeCode;\n\n\t\t\t\t$(self.remainingTime, { title: `${timeToAural(duration - currentTime, lang.minutes || 'minutes', lang.seconds || 'seconds')}` });\n\t\t\t}\n\n\t\t\t$(self.time, { 'aria-valuenow': currentTime, 'aria-valuemin': 0, 'aria-valuemax': duration });\n\n\t\t\tconst dirIsInline = /^(ltr|rtl)$/i.test(timeDir);\n\t\t\tconst axisProp = dirIsInline ? 'width' : 'height';\n\n\t\t\tself.timeMeter.style[axisProp] = `${currentTimePercentage * 100}%`;\n\n\t\t\t// dispatch new \"timechange\" event\n\t\t\tdispatchCustomEvent(media, 'timechange');\n\t\t}\n\t}\n\n\t// when media loads for the first time\n\tfunction onLoadStart() {\n\t\tmedia.removeEventListener('canplaythrough', onCanPlayStart);\n\n\t\t$(media, { canplaythrough: onCanPlayStart });\n\n\t\t$(self.download, { href: media.src, download: media.src });\n\n\t\tonPlayChange();\n\t\tonVolumeChange();\n\t\tonFullscreenChange();\n\t\tonTimeChange();\n\t}\n\n\t// when the immediate current playback position is available\n\tfunction onLoadedData() {\n\t\tonTimeChange();\n\t}\n\n\t// when the media can play\n\tfunction onCanPlayStart() {\n\t\tmedia.removeEventListener('canplaythrough', onCanPlayStart);\n\n\t\t// dispatch new \"canplaystart\" event\n\t\tdispatchCustomEvent(media, 'canplaystart');\n\n\t\tif (!paused || media.autoplay) {\n\t\t\tmedia.play();\n\t\t}\n\t}\n\n\t// when the volume changes\n\tfunction onVolumeChange() {\n\t\tconst volumePercentage = media.muted ? 0 : media.volume;\n\t\tconst isMuted = !volumePercentage;\n\n\t\t$(self.volume, { 'aria-valuenow': volumePercentage, 'aria-valuemin': 0, 'aria-valuemax': 1 });\n\n\t\tconst dirIsInline = /^(ltr|rtl)$/i.test(volumeDir);\n\t\tconst axisProp = dirIsInline ? 'width' : 'height';\n\n\t\tself.volumeMeter.style[axisProp] = `${volumePercentage * 100}%`;\n\n\t\t$(self.mute, { 'aria-label': isMuted ? lang.unmute || 'unmute' : lang.mute || 'mute' });\n\t\t$(self.muteSymbol, { 'aria-hidden': isMuted });\n\t\t$(self.unmuteSymbol, { 'aria-hidden': !isMuted });\n\t}\n\n\tfunction onFullscreenChange() {\n\t\tconst isFullscreen = player === fullscreenElement();\n\n\t\t$(self.fullscreen, { 'aria-label': isFullscreen ? lang.leaveFullscreen || 'leave full screen' : lang.enterFullscreen || 'enter full screen' });\n\t\t$(self.enterFullscreenSymbol, { 'aria-hidden': isFullscreen });\n\t\t$(self.leaveFullscreenSymbol, { 'aria-hidden': !isFullscreen });\n\t}\n\n\t/* Input Events\n\t/* ====================================================================== */\n\n\t// when the play control is clicked\n\tfunction onPlayClick(event) {\n\t\tevent.preventDefault();\n\n\t\tmedia[media.paused ? 'play' : 'pause']();\n\t}\n\n\t// when the time control\n\tfunction onTimeClick(event) {\n\t\t// handle click if clicked without pointer\n\t\tif (!event.pointerType && !event.detail) {\n\t\t\tonPlayClick(event);\n\t\t}\n\t}\n\n\t// click from mute control\n\tfunction onMuteClick(event) {\n\t\tevent.preventDefault();\n\n\t\tmedia.muted = !media.muted;\n\t}\n\n\t// click from volume control\n\tfunction onVolumeClick(event) {\n\t\t// handle click if clicked without pointer\n\t\tif (!event.pointerType && !event.detail) {\n\t\t\tonMuteClick(event);\n\t\t}\n\t}\n\n\t// click from download control\n\tfunction onDownloadClick() {\n\t\tconst a = document.head.appendChild($('a', { download: '', href: media.src }));\n\n\t\ta.click();\n\n\t\tdocument.head.removeChild(a);\n\t}\n\n\t// click from fullscreen control\n\tfunction onFullscreenClick() {\n\t\tif (requestFullscreen) {\n\t\t\tif (player === fullscreenElement()) {\n\t\t\t\t// exit fullscreen\n\t\t\t\texitFullscreen().call(document);\n\t\t\t} else {\n\t\t\t\t// enter fullscreen\n\t\t\t\trequestFullscreen.call(player);\n\n\t\t\t\t// maintain focus in internet explorer\n\t\t\t\tself.fullscreen.focus();\n\n\t\t\t\t// maintain focus in safari\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tself.fullscreen.focus();\n\t\t\t\t}, 200);\n\t\t\t}\n\t\t} else if (media.webkitSupportsFullscreen) {\n\t\t\t// iOS allows fullscreen of the video itself\n\t\t\tif (media.webkitDisplayingFullscreen) {\n\t\t\t\t// exit ios fullscreen\n\t\t\t\tmedia.webkitExitFullscreen();\n\t\t\t} else {\n\t\t\t\t// enter ios fullscreen\n\t\t\t\tmedia.webkitEnterFullscreen();\n\t\t\t}\n\n\t\t\tonFullscreenChange();\n\t\t}\n\t}\n\n\t// keydown from play control or current time control\n\tfunction onTimeKeydown(event) {\n\t\tconst { keyCode, shiftKey } = event;\n\n\t\t// 37: LEFT, 38: UP, 39: RIGHT, 40: DOWN\n\t\tif (37 <= keyCode && 40 >= keyCode) {\n\t\t\tevent.preventDefault();\n\n\t\t\tconst isLTR = /^(btt|ltr)$/.tests(timeDir);\n\t\t\tconst offset = 37 === keyCode || 39 === keyCode ? keyCode - 38 : keyCode - 39;\n\n\t\t\tmedia.currentTime = Math.max(0, Math.min(duration, currentTime + offset * (isLTR ? 1 : -1) * (shiftKey ? 10 : 1)));\n\n\t\t\tonTimeChange();\n\t\t}\n\t}\n\n\t// keydown from mute control or volume control\n\tfunction onVolumeKeydown(event) {\n\t\tconst { keyCode, shiftKey } = event;\n\n\t\t// 37: LEFT, 38: UP, 39: RIGHT, 40: DOWN\n\t\tif (37 <= keyCode && 40 >= keyCode) {\n\t\t\tevent.preventDefault();\n\n\t\t\tconst isLTR = /^(btt|ltr)$/.tests(volumeDir);\n\t\t\tconst offset = 37 === keyCode || 39 === keyCode ? keyCode - 38 : isLTR ? 39 - keyCode : keyCode - 39;\n\n\t\t\tmedia.volume = Math.max(0, Math.min(1, media.volume + offset * (isLTR ? 0.1 : -0.1) * (shiftKey ? 1 : 0.2)));\n\t\t}\n\t}\n\n\t// pointer events from time control\n\tonDrag(self.time, self.timeRange, timeDir, (percentage) => {\n\t\tmedia.currentTime = duration * Math.max(0, Math.min(1, percentage));\n\n\t\tonTimeChange();\n\t});\n\n\t// pointer events from volume control\n\tonDrag(self.volume, self.volumeRange, volumeDir, (percentage) => {\n\t\tmedia.volume = Math.max(0, Math.min(1, percentage));\n\t});\n\n\tonLoadStart();\n}\n\n/* Handle Drag Ranges\n/* ========================================================================== */\n\nfunction onDrag(target, innerTarget, dir, listener) { // eslint-disable-line max-params\n\tconst hasPointerEvent = undefined !== target.onpointerup;\n\tconst hasTouchEvent   = undefined !== target.ontouchstart;\n\tconst pointerDown = hasPointerEvent ? 'pointerdown' : hasTouchEvent ? 'touchstart' : 'mousedown';\n\tconst pointerMove = hasPointerEvent ? 'pointermove' : hasTouchEvent ? 'touchmove' : 'mousemove';\n\tconst pointerUp   = hasPointerEvent ? 'pointerup'   : hasTouchEvent ? 'touchend' : 'mouseup';\n\n\t// ...\n\tconst dirIsInline = /^(ltr|rtl)$/i.test(dir);\n\tconst dirIsStart  = /^(ltr|ttb)$/i.test(dir);\n\n\t// ...\n\tconst axisProp = dirIsInline ? 'clientX' : 'clientY';\n\n\tlet window, start, end;\n\n\t// on pointer down\n\ttarget.addEventListener(pointerDown, onpointerdown);\n\n\tfunction onpointerdown(event) {\n\t\t// window\n\t\twindow = target.ownerDocument.defaultView;\n\n\t\t// client boundaries\n\t\tconst rect = innerTarget.getBoundingClientRect();\n\n\t\t// the container start and end coordinates\n\t\tstart = dirIsInline ? rect.left : rect.top;\n\t\tend   = dirIsInline ? rect.right : rect.bottom;\n\n\t\tonpointermove(event);\n\n\t\twindow.addEventListener(pointerMove, onpointermove);\n\t\twindow.addEventListener(pointerUp, onpointerup);\n\t}\n\n\tfunction onpointermove(event) {\n\t\t// prevent browser actions on this event\n\t\tevent.preventDefault();\n\n\t\t// the pointer coordinate\n\t\tconst position = axisProp in event ? event[axisProp] : event.touches && event.touches[0] && event.touches[0][axisProp] || 0;\n\n\t\t// the percentage of the pointer along the container\n\t\tconst percentage = (dirIsStart ? position - start : end - position) / (end - start);\n\n\t\t// call the listener with percentage\n\t\tlistener(percentage);\n\t}\n\n\tfunction onpointerup() {\n\t\twindow.removeEventListener(pointerMove, onpointermove);\n\t\twindow.removeEventListener(pointerUp, onpointerup);\n\t}\n}\n\n/* Time To Timecode\n/* ====================================================================== */\n\nfunction timeToTimecode(time) {\n\treturn `${`0${Math.floor(time / 60)}`.slice(-2)}:${`0${Math.floor(time % 60)}`.slice(-2)}`;\n}\n\n/* Time To Aural\n/* ====================================================================== */\n\nfunction timeToAural(time, langMinutes, langSeconds) {\n\treturn `${Math.floor(time / 60)} ${langMinutes}, ${Math.floor(time % 60)} ${langSeconds}`;\n}\n\n/* Update Elements\n/* ========================================================================== */\n\nfunction $(rawid) {\n\tconst id = rawid instanceof Node ? rawid : document.createElement(rawid);\n\tconst args = [].slice.call(arguments, 1);\n\n\tfor (let index in args) {\n\t\tif (args[index] instanceof Node) {\n\t\t\tid.appendChild(args[index]);\n\t\t} else if (Object(args[index]) === args[index]) {\n\t\t\tfor (let attr in args[index]) {\n\t\t\t\tif ('function' === typeof args[index][attr]) {\n\t\t\t\t\tid.addEventListener(attr, args[index][attr]);\n\t\t\t\t} else {\n\t\t\t\t\tid.setAttribute(attr, args[index][attr]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn id;\n}\n\nfunction svg(prefix, svgs, type) { // eslint-disable-line max-params\n\tconst svgns = 'http://www.w3.org/2000/svg';\n\tconst use = document.createElementNS(svgns, 'use');\n\n\tuse.setAttributeNS('http://www.w3.org/1999/xlink', 'href', svgs[type] || `#symbol-${type}`);\n\n\treturn $(document.createElementNS(svgns, 'svg'), {\n\t\tclass: `${prefix}-symbol ${prefix}-${type}-symbol`,\n\t\trole: 'presentation'\n\t}, use);\n}\n\n/* Dispatch Events\n/* ====================================================================== */\n\nfunction dispatchCustomEvent(node, type) {\n\tconst event = document.createEvent('CustomEvent');\n\n\tevent.initCustomEvent(type, true, true, undefined);\n\n\tnode.dispatchEvent(event);\n}\n"],"names":["onDrag","target","innerTarget","dir","listener","hasPointerEvent","undefined","onpointerup","hasTouchEvent","ontouchstart","pointerDown","pointerMove","pointerUp","dirIsInline","test","dirIsStart","axisProp","window","start","end","onpointermove","event","preventDefault","position","touches","removeEventListener","addEventListener","ownerDocument","defaultView","rect","getBoundingClientRect","left","top","right","bottom","timeToTimecode","time","Math","floor","slice","timeToAural","langMinutes","langSeconds","$","rawid","id","Node","document","createElement","args","call","arguments","index","appendChild","Object","attr","setAttribute","svg","prefix","svgs","type","svgns","use","createElementNS","setAttributeNS","dispatchCustomEvent","node","createEvent","initCustomEvent","dispatchEvent","media","rawopts","self","this","opts","lang","timeDir","volumeDir","onCanPlayStart","onLoadStart","onPlayChange","onTimeChange","onVolumeChange","playSymbol","pauseSymbol","play","class","click","onPlayClick","keydown","onTimeKeydown","timeMeter","timeRange","role","aria-label","currentTime","data-dir","pointerType","detail","currentTimeText","createTextNode","remainingTimeText","remainingTime","muteSymbol","unmuteSymbol","mute","onMuteClick","onVolumeKeydown","volumeMeter","volumeRange","volume","downloadSymbol","download","a","head","href","src","removeChild","enterFullscreenSymbol","leaveFullscreenSymbol","fullscreen","requestFullscreen","player","fullscreenElement","focus","webkitSupportsFullscreen","webkitDisplayingFullscreen","webkitExitFullscreen","webkitEnterFullscreen","toolbar","fullscreenchange","_fullscreenchange","_fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","_requestFullscreen","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","exitFullscreen","_exitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen","onFullscreenChange","playsinline","webkit-playsinline","tabindex","controls","parentNode","insertBefore","replaceChild","paused","duration","interval","pause","aria-hidden","setInterval","currentTimePercentage","currentTimeCode","remainingTimeCode","nodeValue","title","minutes","seconds","aria-valuenow","aria-valuemin","aria-valuemax","style","canplaythrough","autoplay","volumePercentage","muted","isMuted","unmute","isFullscreen","leaveFullscreen","enterFullscreen","keyCode","shiftKey","isLTR","tests","offset","max","min","percentage"],"mappings":"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"}